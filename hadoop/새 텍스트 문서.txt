1.csv 로 데이터 가져오기
var flightData = spark.read.option("inferSchema","true").option("header","true").csv("2015-summary.csv")
2. sql을 사용하기 위해 DataFrame을 임시 테이블로 만들기
flightData.createOrReplaceTempView('flightData')
3. 쿼리 적용하기
flightData_sql = spark.sql("""
      select DEST_COUNTRY_NAME, count(*)
      from flightData
      group by DEST_COUNTRY_NAME
      """)
4. 내용 확인하기
flightData_sql.show()
5. 3번과 동일하지만 DataFrame 사용하기
var flightData_gb =  flightData.groupBy("DEST_COUNTRY_NAME").count()
6. 내용 확인하기
flightData_gb.show()
:white_check_mark:
1






5:26
import org.apache.spark.sql.functions.max
5:31
var result = flightData.select(max("count")).take(1)